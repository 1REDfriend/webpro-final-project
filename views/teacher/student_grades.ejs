<%- include('../layouts/header') %>

    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
        <h2 class="mb-0" style="margin: 0;">ผลการเรียน - <%= student.name %> (<%= student.student_code %>)</h2>
        <a href="/teacher/classes" class="btn btn-secondary">กลับหน้ารายชื่อนักเรียน</a>
    </div>

    <div class="card mb-4">
        <p><strong>ห้องเรียน:</strong>
            <%= student.classroom_name %>
        </p>
        <p style="margin: 0;"><strong>คะแนนพฤติกรรม:</strong>
            <span style="font-weight: bold; color: <%= student.behavior_score < 50 ? '#ff6b6b' : '#00b894' %>">
                <%= student.behavior_score %>
            </span>
        </p>
    </div>

    <% if (groups && groups.length> 0) { %>
        <% groups.forEach(group=> { %>
            <div class="card mb-4">
                <h3
                    style="margin-top: 0; margin-bottom: 1rem; border-bottom: 2px solid var(--accent); padding-bottom: 0.5rem; display: inline-block;">
                    ชั้นปี <%= group.level %> ภาคเรียนที่ <%= group.semester %>
                </h3>

                <table>
                    <thead>
                        <tr>
                            <th>รหัสวิชา</th>
                            <th>ชื่อวิชา</th>
                            <th>หน่วยกิต</th>
                            <th>คะแนนเก็บ</th>
                            <th>คะแนนสอบ</th>
                            <th>รวม</th>
                            <th>เกรด</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% group.grades.forEach(item=> { %>
                            <tr>
                                <td>
                                    <%= item.code %>
                                </td>
                                <td>
                                    <%= item.name %>
                                </td>
                                <td>
                                    <%= item.credit %>
                                </td>
                                <td>
                                    <%= item.grade_midterm !==null ? item.grade_midterm : '-' %>
                                </td>
                                <td>
                                    <%= item.grade_final !==null ? item.grade_final : '-' %>
                                </td>
                                <td>
                                    <%= item.total_score !==null ? item.total_score : '-' %>
                                </td>
                                <td style="font-weight: bold; color: var(--accent);">
                                    <%= item.grade_char || '-' %>
                                </td>
                            </tr>
                            <% }); %>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="6" style="text-align: right; font-weight: bold; padding-right: 1rem;">
                                เกรดเฉลี่ยภาคเรียนนี้</td>
                            <td style="font-weight: bold; font-size: 1.1rem; color: #00b894;">
                                <%= group.gpa %>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
            <% }); %>

                <div class="card" style="background-color: #f8f9fa; border-left: 5px solid var(--accent);">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <h3 style="margin: 0;">เกรดเฉลี่ยสะสม (GPAX)</h3>
                        <span style="font-weight: bold; font-size: 1.5rem; color: #00b894;">
                            <%= gpa %>
                        </span>
                    </div>
                </div>
                <% } else { %>
                    <div class="card text-center py-5" style="color: #777;">
                        <p>ไม่พบข้อมูลผลการเรียน</p>
                    </div>
                    <% } %>

                        <%- include('../layouts/footer') %>